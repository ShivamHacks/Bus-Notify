<!DOCTYPE html>
<html>
<head>
	<title>Get Location</title>
</head>
<body>

	<img src="/pin.png">

	<script src="/geo.js"></script>
	<script>
		var baseURL = "http://localhost:3000/api/"; // http://bus-notify.herokuapp.com/api/
		var userID = "<%= userID %>";

		navigator.geolocation.getAccurateCurrentPosition(function(position) {
			// onSuccess
			console.log(position);

			var lat1 = position.coords.latitude;
			var lon1 = position.coords.longitude;
			var lat2 = lat1 - 2;
			var lon2 = lon1 - 2;


			var R = 6371; // km
			var dLat = (lat2-lat1).toRad();
			var dLon = (lon2-lon1).toRad();
			var lat1 = lat1.toRad();
			var lat2 = lat2.toRad();

			var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
			Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
			var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
			var d = R * c;

			console.log(c);

		}, function(error) {
			// onFailure
			console.log(error);
		}, function(position) {
		}, {
			desiredAccuracy: 20, // 20 meters
			maxWait: 15000 // 15 seconds
		});
	</script>

</body>
</html>

